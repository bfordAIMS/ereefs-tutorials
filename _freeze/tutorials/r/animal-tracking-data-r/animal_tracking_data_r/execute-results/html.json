{
  "hash": "b6c82a3fa64fdcdb3273596147a0b1d1",
  "result": {
    "markdown": "---\ntitle: \"Adding eReefs data to animal tracking detections {{< fa brands r-project >}}\"\n---\n\n::: {.cell}\n\n:::\n\n\n\n:::{.callout-note appearance=\"simple\"}\nThis tutorial builds on the techniques introduced in [Accessing eReefs data from the AIMS server](../server-data-access-r/server_data_access_r.html).\n:::\n\nWe will look at how to get eReefs point data from the [AIMS server](http://thredds.ereefs.aims.gov.au/thredds/catalog.html)corresponding to the logged locations of tagged marine animals.\n\n## R packages\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(readr) # to efficiently read in data\nlibrary(janitor) # to create clean variable names\nlibrary(tidyverse) # for data manipulation and plotting with ggplot2\nlibrary(lubridate) # for working with date and time variables \nlibrary(leaflet) # to create an interactive map of the tracking locations\n```\n:::\n\n\n## Tracking marine animals\n\nMarine animals are commonly tracked using either acoustic or satellite tags. These tags are attached to the animals and transmit signals back to recievers, logging the animal's location -- and possibly other data such as depth, temperature, and animal movement profiles -- at different points in time. \n\nAcoustic tracking requires a network of recievers to be placed in the ocean in order to pick up the tags' transmitted signals when they come within range (typically about 500 m). Acoustic tracking has the advantage of being able transmit and recieve signals underwater, however is limited by the coverage of the reciever network and whether this is suitable for a given species and research question. In some instances, researchers do without the reciever network and follow the animals around in a boat to recieve the data.\n\nSatellite tracking, on the other hand, is able to track animals over virtually the entire ocean as the tags transmit signals to a network of satellites orbiting the earth. However, unlike acoustic tags, the signals cannot be transmitted through water and the tagged animals must breach the ocean surface in order to have their location logged and other recorded data, such as depth and temperature profiles, be recieved. The accuracy of the logged location depends on the quality of the transmitted signal. For high-quality signals, the location uncertainty can be in the hundreds of metres, however for bad quality signals this can blow out to over 10 km.\n\n## The data\n\nWe will use satellite tracking data for Loggerhead Sea Turtles (*Caretta caretta*) provided in [Strydom (2022)](https://doi.org/10.15468/k4s6ap). \n\n:::{.callout-caution appearance=\"simple\"}\nThis dataset is a summarized representation of the tracking locations per 1-degree cell. This implies a coordinate uncertainty of roughly 110 km. This level of uncertainty renders the data virtually useless for any practical application, though the data will suffice for the purposes of this tutorial. Records which are landbased as a result of the uncertainty have been removed and from here on in we will just pretend that the coordinates are accurate.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Read in data\nloggerhead_data <- read_csv(\"data/Loggerhead_Sea_Turtle_satellite_tracking_detections__Strydom_2022_DOI10-15468-k4s6ap.csv\") |> \n  clean_names() |> # clean up variable names\n  mutate( # rename variables for easier use\n    record_id = gbif_id,\n    latitude = decimal_latitude, \n    longitude = decimal_longitude, \n    date_time = event_date\n  )\n\n# Remove land based records (as a result of coordinate uncertainty)\nland_based_records <- c(4022992331, 4022992326, 4022992312, 4022992315, 4022992322, 4022992306)\nloggerhead_data <- loggerhead_data |> dplyr::filter(!(record_id %in% land_based_records))\n\n# Select the variables relevant to this tutorial\nloggerhead_data <- loggerhead_data |> \n  select(longitude, latitude, date_time, record_id, species)\n\n# Create interactive map of the records\nloggerhead_data |> \n  leaflet() |> \n  addTiles() |> \n  addMarkers(label = ~date_time)\n```\n\n::: {.cell-output-display}\n```{=html}\n<div class=\"leaflet html-widget html-fill-item-overflow-hidden html-fill-item\" id=\"htmlwidget-00b9580fb93656d91275\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-00b9580fb93656d91275\">{\"x\":{\"options\":{\"crs\":{\"crsClass\":\"L.CRS.EPSG3857\",\"code\":null,\"proj4def\":null,\"projectedBounds\":null,\"options\":{}}},\"calls\":[{\"method\":\"addTiles\",\"args\":[\"https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png\",null,null,{\"minZoom\":0,\"maxZoom\":18,\"tileSize\":256,\"subdomains\":\"abc\",\"errorTileUrl\":\"\",\"tms\":false,\"noWrap\":false,\"zoomOffset\":0,\"zoomReverse\":false,\"opacity\":1,\"zIndex\":1,\"detectRetina\":false,\"attribution\":\"&copy; <a href=\\\"https://openstreetmap.org\\\">OpenStreetMap<\\/a> contributors, <a href=\\\"https://creativecommons.org/licenses/by-sa/2.0/\\\">CC-BY-SA<\\/a>\"}]},{\"method\":\"addMarkers\",\"args\":[[-20.5,-25.5,-24.5,-18.5,-14.5,-26.5,-19.5,-10.5,-20.5,-22.5,-21.5,-11.5,-19.5,-18.5,-24.5,-15.5,-16.5,-13.5,-21.5,-12.5,-9.5,-23.5,-16.5,-23.5,-17.5],[150.5,153.5,152.5,147.5,145.5,153.5,148.5,143.5,149.5,151.5,150.5,143.5,149.5,146.5,153.5,145.5,145.5,144.5,151.5,143.5,143.5,152.5,146.5,151.5,146.5],null,null,null,{\"interactive\":true,\"draggable\":false,\"keyboard\":true,\"title\":\"\",\"alt\":\"\",\"zIndexOffset\":0,\"opacity\":1,\"riseOnHover\":false,\"riseOffset\":250},null,null,null,null,[\"2022-01-17 17:06:32\",\"2022-01-02 21:49:55\",\"2021-12-21 17:57:22\",\"2022-01-27 17:00:04\",\"2022-02-12 10:34:12\",\"2022-02-12 08:59:01\",\"2022-01-23 07:02:18\",\"2022-04-14 06:31:48\",\"2022-01-19 17:44:38\",\"2022-01-09 20:25:01\",\"2022-01-14 18:26:17\",\"2022-04-09 22:00:54\",\"2022-01-21 07:22:08\",\"2022-01-30 17:02:42\",\"2022-02-03 21:37:56\",\"2022-02-09 18:33:03\",\"2022-02-07 07:15:30\",\"2022-03-25 07:10:49\",\"2022-01-13 06:28:09\",\"2022-04-01 18:41:42\",\"2022-04-21 10:30:09\",\"2022-01-05 07:33:53\",\"2022-02-06 18:25:38\",\"2022-01-06 05:03:23\",\"2022-02-02 09:14:56\"],{\"interactive\":false,\"permanent\":false,\"direction\":\"auto\",\"opacity\":1,\"offset\":[0,0],\"textsize\":\"10px\",\"textOnly\":false,\"className\":\"\",\"sticky\":true},null]}],\"limits\":{\"lat\":[-26.5,-9.5],\"lng\":[143.5,153.5]}},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n\nLoggerhead Sea Turtle satellite tracking records (December 2021 - April 2022)\n:::\n:::\n\n\n\n\nStrydom A. 2022. Wreck Rock Turtle Care - satellite tracking. Data downloaded from [OBIS-SEAMAP](http://seamap.env.duke.edu/dataset/2178); originated from [Satellite Tracking and Analysis Tool (STAT)](http://www.seaturtle.org/tracking/index.shtml?project_id=1381). [DOI: 10.15468/k4s6ap](https://doi.org/10.15468/k4s6ap) accessed via [GBIF.org](https://www.gbif.org/) on 2023-02-17.",
    "supporting": [
      "animal_tracking_data_r_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../../site_libs/htmlwidgets-1.6.1/htmlwidgets.js\"></script>\r\n<script src=\"../../../site_libs/jquery-1.12.4/jquery.min.js\"></script>\r\n<link href=\"../../../site_libs/leaflet-1.3.1/leaflet.css\" rel=\"stylesheet\" />\r\n<script src=\"../../../site_libs/leaflet-1.3.1/leaflet.js\"></script>\r\n<link href=\"../../../site_libs/leafletfix-1.0.0/leafletfix.css\" rel=\"stylesheet\" />\r\n<script src=\"../../../site_libs/proj4-2.6.2/proj4.min.js\"></script>\r\n<script src=\"../../../site_libs/Proj4Leaflet-1.0.1/proj4leaflet.js\"></script>\r\n<link href=\"../../../site_libs/rstudio_leaflet-1.3.1/rstudio_leaflet.css\" rel=\"stylesheet\" />\r\n<script src=\"../../../site_libs/leaflet-binding-2.1.1/leaflet.js\"></script>\r\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}